from src.vat.cli import parse_arguments
from src.vat.plugins.requests_handler import make_request


def main():
    args = parse_arguments()

    if args.verbose:
        print(f"Scanning {args.url} using the {args.plugin} plugin...")

    response, success, vulnerable = make_request(
        args.url, payload=args.payload, verify_ssl=not args.no_verify, verbose=args.verbose)

    if success:
        if vulnerable:
            print(f"XSS vulnerabilities found for {args.url}")
        else:
            print(f"No XSS vulnerabilities found for {args.url}")
    else:
        print(f"Scan failed for {args.url}")


if __name__ == "__main__":
    main()
