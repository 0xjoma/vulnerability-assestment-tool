from src.vat.cli import parse_arguments
from src.vat.plugins.requests_handler import make_request


def main():
    # Parse CLI arguments
    args = parse_arguments()

    print(f"Scanning {args.url} using the {args.plugin} plugin...")

    # Handle SSL verification based on CLI argument
    verify_ssl = not args.no_verify

    # Make the request and perform vulnerability checks
    response, success, vulnerable = make_request(
        args.url, payload="", verify_ssl=verify_ssl)

    if success:
        if vulnerable:
            print(f"XSS vulnerabilities found for {args.url}")
        else:
            print(f"No XSS vulnerabilities found for {args.url}")
    else:
        print(f"Scan failed for {args.url}")

    # Additional code for handling scan results and output features


if __name__ == "__main__":
    main()
