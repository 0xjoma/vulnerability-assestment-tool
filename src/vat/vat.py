# vat.py

from src.vat.cli import parse_arguments
from src.vat.requests_handler import make_request
from src.vat.plugins.xss import check_xss


def main():
    # Parse CLI arguments
    args = parse_arguments()
    print(f"Scanning {args.url} using the {args.plugin} plugin...")

    # Handle SSL verification based on CLI argument
    verify_ssl = not args.no_verify

    # Check for vulnerabilities based on the chosen plugin
    if args.plugin == "xss":
        vulnerable, performed_check = check_xss(args.url, verify_ssl)
        if performed_check:
            if vulnerable:
                print(f"{args.url} is vulnerable to XSS!")
            else:
                print(f"{args.url} is not vulnerable to XSS.")
        else:
            # Error message is printed by the requests_handler module
            print(
                f"Scanning of {args.url} was aborted due to SSL verification failure.")


if __name__ == "__main__":
    main()